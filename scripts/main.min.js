/**
 * soundOmath
 * Playing Sound App
 * Compiled: Sat Feb 06 2016 22:21:54 GMT+0100 (CET)
 * @version v0.2.0
 * @link https://github.com/mgje
 * @copyright MIT
 */
!function t(n,e,r){function i(a,u){if(!e[a]){if(!n[a]){var l="function"==typeof require&&require;if(!u&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=e[a]={exports:{}};n[a][0].call(f.exports,function(t){var e=n[a][1][t];return i(e?e:t)},f,f.exports,t,n,e,r)}return e[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,n,e){"use strict";$(document).ready(function(){var t=function(t,n,e,r){if(r){var i=n.selectAll("svg g").data(t),o=i.selectAll("g").data(function(t){return t});o.exit().remove(),o.enter().append("g").attr("transform",function(t,n){return console.log(t,n),"translate("+28*n+",0)"});var a=o.selectAll("rect").data(function(t){return t});a.exit().remove(),a.attr("fill",function(t,n){return e[t]}).attr("x",function(n,e,r){return I/t[0][r].length*e}).attr("width",function(n,e,r){return I/t[0][r].length}).attr("height",M).enter().append("rect").attr("fill",function(t,n){return e[t]}).attr("x",function(n,e,r){return I/t[0][r].length*e}).attr("width",function(n,e,r){return I/t[0][r].length}).attr("height",M)}else n.selectAll("svg g rect").data(t[0]).attr("fill",function(t,n){return e[t]}).enter().append("rect").attr("x",function(t,n){return 28*n}).attr("width",I).attr("height",M)},n=function(t,n,e,r){var i=n.selectAll("svg g").data(t).enter().append("g").attr("transform",function(t,n){return"translate(0, "+54*n+")"});if(r){var o=i.selectAll("g").data(function(t){return t}).enter().append("g").attr("transform",function(t,n){return"translate("+28*n+",0)"});o.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(n,e,r){return I/t[0][r].length*e}).attr("fill",function(t,n){return e[t]}).attr("width",function(n,e,r){return I/t[0][r].length}).attr("height",M)}else i.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t,n){return 28*n}).attr("fill",function(t,n){return e[t]}).attr("width",I).attr("height",M);i.selectAll("line").data(function(t){var n=Math.trunc(t.length/10),e=new Array(n+1).fill(0);return e}).enter().append("line").attr("x1",function(t,n){return 280*n+1}).attr("y1",20).attr("x2",function(t,n){return 280*n+1}).attr("y2",40).style("stroke","black").style("stroke-width","2px"),i.selectAll("text").data(function(t){var n=Math.trunc(t.length/10),e=new Array(n+1).fill(0);return e}).enter().append("text").attr("x",function(t,n){return 280*n+5}).attr("y","38").attr("font-family","sans-serif").text(function(t,n,e){return 40*e+10*n+1})},e=function(t){var n=[];"undefined"==typeof t&&alert("row is undefined");for(var e="",r=1;4>r;r++)e="#btn-row"+t+"-"+r,n.push(e);var i=[];for(var r in n){var o=$(n[r]).parent().parent().children("input")[0],a=0;"undefined"!=typeof o&&(a=o.value),i.push(a)}return i},r=function(t,n,e){var r=[],i=[];i.push(r);for(var o=void 0,a=void 0,u=0;u<t.length;u++)o=[],o.push(t[u]),o.push(0===n[u]?0:n[u]+3),o.push(0===e[u]?0:e[u]+6),a=new Set(o),a.size>1&&a.has(0)&&a["delete"](0),r.push(Array.from(a));return i},i=function(t){for(var n=[],e=0;e<t.length;e++)n.push(parseInt(t[e]));for(var r=1,i=[],o=void 0,a=void 0,u=0,e=0;e<n.length&&(o=e,a=n[o],!(a>0));e++);for(var l=0;N>l;l+=1){var c=[];i.push(c);for(var e=0;j>e;e+=1){if(r===a){for(u=o+1;n[(o+1)%n.length]<1;)o=(o+1)%n.length;a+=n[(o+1)%n.length],o=(o+1)%n.length}else u=0;c.push(u),r+=1}}return i},o=function(t,n,e,r){$(t).attr("fill",r),setTimeout(function(){$(t).attr("fill",n)},1e3*e)},a=function(n,o,a){for(var u=[],l="",c=1;4>c;c++)l="#btn-row"+n+"-"+c,u.push(l);for(var c in u)$(u[c]).parent().parent().children("input.form-control").change(function(){var u=i(e(n));t(u,o,a,!1);var l=i(e(1)),c=i(e(2)),f=i(e(3)),s=r(l[0],c[0],f[0]);t(s,d3.select("#chart-sum"),[0,1,2,3,4,5,6,7,8,9].map(function(t){return y[t].color}),!0)})},u=function(t){for(var n=[],e="",r=1;4>r;r++)e="#btn-row"+t+"-"+r,n.push(e);var i=jQuery.Event("change"),o=function(t){$(n[t]).parent().children("ul.dropdown-menu").on("click",function(e){$(n[t]).parent().parent().children("input.form-control:first").attr("value",e.target.text).trigger(i)})};for(var r in n)o(r)},l=function(t){for(var n=[],e="",r=1;4>r;r++)e="#btn-row"+t+"-"+r+"-ton",n.push(e);for(var r in n)$(n[r]).parent().children("ul.dropdown-menu").on("click",function(t){var n=parseInt(t.target.parentElement.parentElement.getAttribute("nr"));y[n].instrument=t.target.text,v(y,n)})},c=function(){var t=[],n="#btn-row1-0-ton";t.push(n);for(var e in t)$(t[e]).parent().children("ul.dropdown-menu").on("click",function(t){y[0].instrument=t.target.text,v(y,0)})},f=function(t){for(var n=[],e="",r=1;4>r;r++)e="#btn-row"+t+"-"+r+"-volume",n.push(e);jQuery.Event("change");for(var r in n)$(n[r]).parent().children("ul.dropdown-menu").on("click",function(t){var n=parseInt(t.target.parentElement.parentElement.getAttribute("nr"));y[n].vol=t.target.text,y[n].gain=1*parseInt(t.target.text)/100,v(y,n)})},s=function(){var t=[],n="#btn-row1-0-volume";t.push(n);for(var e in t)$(t[e]).parent().children("ul.dropdown-menu").on("click",function(t){y[0].vol=t.target.text,y[0].gain=1*parseInt(t.target.text)/100,v(y,0)})},v=function(t,n){var e=$("#"+t[n].id).children("input");n>0?(e[1].value=t[n].instrument,e[2].value=t[n].vol):(e[0].value=t[n].instrument,e[1].value=t[n].vol)},d=function(t){for(var n=0;n<t.length;n++)v(t,n)},h=function(){$("#playmusicbtn").on("click",function(t){m=!0,D()})},p=function(){$("#stopmusicbtn").on("click",function(t){m=!1})},g=function(t,n,e,r){var i=t+e,o=y[n].gain,a=x.createGain();a.gain.value=o,a.connect(x.destination);var u=x.createGain();u.connect(a),u.gain.value=0,u.gain.setTargetAtTime(1,t,F[0]),u.gain.setTargetAtTime(0,i,F[1]);var l=x.createOscillator();l.connect(u),l.type=O,l.detune.value=q[y[n].instrument].detune,l.frequency.value=240;var c=x.createGain();c.gain.value=k,c.connect(l.detune);var f=x.createOscillator();f.connect(c),f.frequency.value=T,l.start(t),f.start(t),l.stop(i+2),f.stop(i+2)},w=function V(){if(!m||0===A.length)return void console.log("stop");for(var t=x.currentTime;A.length>0&&A[0][0]<t+.15;){var n=A.splice(0,1);g(n[0][0],n[0][1],n[0][2],y[n[0][1]].gain),o(n[0][3],y[n[0][1]].color,n[0][2],y[n[0][1]].hover)}setTimeout(V,90)},m=!0,A=[],x=null;try{window.AudioContext=window.AudioContext||window.webkitAudioContext;var x=new AudioContext}catch(b){console.log("No Web Audio API support")}$("body").on("touchend",function(t){var n=x.createBuffer(1,1,22050),e=x.createBufferSource();e.buffer=n,e.connect(x.destination),"undefined"!=typeof e.noteOn&&e.noteOn(0);var r=null;r=x.createOscillator(),r.type="square",r.frequency.value=440,r.connect(x.destination);var i=x.currentTime;r.start(i+.5),r.stop(i+.9)});var y=[{nr:0,gain:.1,vol:"10%",color:"#757575",hover:"#000000",instrument:"D3",id:"ig-row1-0",visible:!0},{nr:1,gain:.8,vol:"80%",color:"#296EAA",hover:"#094E8A",instrument:"E3",id:"ig-row1-1",visible:!0},{nr:2,gain:0,vol:"0%",color:"#5491B5",hover:"#346175",instrument:"F3",id:"ig-row1-2",visible:!1},{nr:3,gain:0,vol:"0%",color:"#79BEFA",hover:"#599EBA",instrument:"G3",id:"ig-row1-3",visible:!1},{nr:4,gain:.5,vol:"50%",color:"#4BA84B",hover:"#2B882B",instrument:"A4",id:"ig-row2-1",visible:!0},{nr:5,gain:0,vol:"0%",color:"#547249",hover:"#245219",instrument:"B4",id:"ig-row2-2",visible:!1},{nr:6,gain:0,vol:"0%",color:"#1F6241",hover:"#1F6241",instrument:"C4",id:"ig-row2-3",visible:!1},{nr:7,gain:.3,vol:"30%",color:"#DB3833",hover:"#AB1813",instrument:"D4",id:"ig-row3-1",visible:!0},{nr:8,gain:0,vol:"0%",color:"#B30B0B",hover:"#530B0B",instrument:"E4",id:"ig-row3-2",visible:!1},{nr:9,gain:0,vol:"0%",color:"#A1123F",hover:"#51021F",instrument:"F4",id:"ig-row3-3",visible:!1}],q={D3:{freq:440,detune:-700},E3:{freq:440,detune:-500},F3:{freq:440,detune:-400},G3:{freq:440,detune:-200},A4:{freq:440,detune:0},B4:{freq:440,detune:200},C4:{freq:440,detune:300},D4:{freq:440,detune:500},E4:{freq:440,detune:700},F4:{freq:440,detune:800},G4:{freq:440,detune:1e3}},B=.5,E=.3,k=.3,F=[.01,.1],T=6,O="sawtooth",C=function(t){t.map(function(t){if(t.visible)$("#"+t.id).show();else{var n=$("#"+t.id);n.hide(),n.children("input")[0].value="0"}})},D=function(){var t=void 0,n=d3.select("#chart-sum").select("g").selectAll("g").data(),e=d3.select("#chart-sum").select("g").selectAll("g")[0],r=x.currentTime;A=[];for(var i=0;i<n.length;i++){var o=n[i];for(t=0;t<o.length;t++){var a=[];a.push(i*B+r+1e-4*t),a.push(o[t]),a.push(E),a.push(d3.select(e[i]).selectAll("rect")[0][t]),A.push(a)}}w()},G=function(t){var n=1280,e=45,r="0 0 "+(n+70)+" "+e,i=d3.select(t),o=i.append("svg").attr("width",n).attr("height",e).attr("viewBox",r).attr("preserveAspectRatio","xMidYMid meet");return o},I=20,M=20,N=1,j=48;C(y),d(y);var z=G("#chart"),Q=[0,1,2,3].map(function(t){return y[t].color}),S=i(e(1));n(S,z,Q,!1);var U=G("#chart-2"),_=[0,4,5,6].map(function(t){return y[t].color}),L=i(e(2));n(L,U,_,!1);var P=G("#chart-3"),R=[0,7,8,9].map(function(t){return y[t].color}),W=i(e(3));n(W,P,R,!1);var Y=G("#chart-sum"),H=[0,1,2,3,4,5,6,7,8,9].map(function(t){return y[t].color}),J=r(S[0],L[0],W[0]);n(J,Y,H,!0),d3.select(window).on("resize",function(){var t=$(window).width();z.attr("width",t),U.attr("width",t),P.attr("width",t),Y.attr("width",t)});var K=$(window).width();z.attr("width",K),U.attr("width",K),P.attr("width",K),Y.attr("width",K),s(),c(),[1,2,3].map(u),[1,2,3].map(l),[1,2,3].map(f),a(1,z,Q),a(2,U,_),a(3,P,R),h(),p()})},{}]},{},[1]);