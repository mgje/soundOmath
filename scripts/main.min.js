/**
 * soundOmath
 * Playing Sound App
 * Compiled: Tue Feb 09 2016 09:32:03 GMT+0100 (CET)
 * @version v0.2.0
 * @link https://github.com/mgje
 * @copyright MIT
 */
!function t(n,e,r){function o(a,u){if(!e[a]){if(!n[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=e[a]={exports:{}};n[a][0].call(f.exports,function(t){var e=n[a][1][t];return o(e?e:t)},f,f.exports,t,n,e,r)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,n,e){"use strict";$(document).ready(function(){var t=[{nr:0,gain:.2,vol:"20%",color:"#757575",hover:"#000000",instrument:"D3",id:"ig-row1-0",visible:!0},{nr:1,gain:.8,vol:"20%",color:"#296EAA",hover:"#094E8A",instrument:"A4",id:"ig-row1-1",visible:!0},{nr:2,gain:0,vol:"0%",color:"#5491B5",hover:"#346175",instrument:"F3",id:"ig-row1-2",visible:!1},{nr:3,gain:0,vol:"0%",color:"#79BEFA",hover:"#599EBA",instrument:"G3",id:"ig-row1-3",visible:!1},{nr:4,gain:.5,vol:"40%",color:"#4BA84B",hover:"#2B882B",instrument:"D4",id:"ig-row2-1",visible:!0},{nr:5,gain:0,vol:"0%",color:"#547249",hover:"#245219",instrument:"B4",id:"ig-row2-2",visible:!1},{nr:6,gain:0,vol:"0%",color:"#1F6241",hover:"#1F6241",instrument:"C4",id:"ig-row2-3",visible:!1},{nr:7,gain:.3,vol:"80%",color:"#DB3833",hover:"#AB1813",instrument:"G4",id:"ig-row3-1",visible:!0},{nr:8,gain:0,vol:"0%",color:"#B30B0B",hover:"#530B0B",instrument:"E4",id:"ig-row3-2",visible:!1},{nr:9,gain:0,vol:"0%",color:"#A1123F",hover:"#51021F",instrument:"F4",id:"ig-row3-3",visible:!1}],n={D3:{freq:440,detune:-700},E3:{freq:440,detune:-500},F3:{freq:440,detune:-400},G3:{freq:440,detune:-200},A4:{freq:440,detune:0},B4:{freq:440,detune:200},C4:{freq:440,detune:300},D4:{freq:440,detune:500},E4:{freq:440,detune:700},F4:{freq:440,detune:800},G4:{freq:440,detune:1e3}},e=20,r=20,o=1,i=48,a=function(t,n,o,i){if(i){var a=n.selectAll("svg g").data(t),u=a.selectAll("g").data(function(t){return t});u.exit().remove(),u.enter().append("g").attr("transform",function(t,n){return"translate("+28*n+",0)"});var c=u.selectAll("rect").data(function(t){return t});c.exit().remove(),c.attr("fill",function(t,n){return o[t]}).attr("x",function(n,r,o){return e/t[0][o].length*r}).attr("width",function(n,r,o){return e/t[0][o].length}).enter().append("rect").attr("fill",function(t,n){return o[t]}).attr("x",function(n,r,o){return e/t[0][o].length*r}).attr("width",function(n,r,o){return e/t[0][o].length}).attr("height",r)}else n.selectAll("svg g rect").data(t[0]).attr("fill",function(t,n){return o[t]}).enter().append("rect").attr("x",function(t,n){return 28*n}).attr("width",e).attr("height",r)},u=function(t,n,o,i){var a=n.selectAll("svg g").data(t).enter().append("g").attr("transform",function(t,n){return"translate(0, "+54*n+")"});if(i){var u=a.selectAll("g").data(function(t){return t}).enter().append("g").attr("transform",function(t,n){return"translate("+28*n+",0)"});u.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(n,r,o){return e/t[0][o].length*r}).attr("fill",function(t,n){return o[t]}).attr("width",function(n,r,o){return e/t[0][o].length}).attr("height",r)}else a.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("x",function(t,n){return 28*n}).attr("fill",function(t,n){return o[t]}).attr("width",e).attr("height",r);a.selectAll("line").data(function(t){var n=Math.trunc(t.length/10),e=new Array(n+1).fill(0);return e}).enter().append("line").attr("x1",function(t,n){return 280*n+1}).attr("y1",20).attr("x2",function(t,n){return 280*n+1}).attr("y2",40).style("stroke","black").style("stroke-width","2px"),a.selectAll("text").data(function(t){var n=Math.trunc(t.length/10),e=new Array(n+1).fill(0);return e}).enter().append("text").attr("x",function(t,n){return 280*n+5}).attr("y","38").attr("font-family","sans-serif").text(function(t,n,e){return 40*e+10*n+1})},c=function(t){var n=[];"undefined"==typeof t&&alert("row is undefined");for(var e="",r=1;4>r;r++)e="#btn-row"+t+"-"+r,n.push(e);var o=[];for(var r in n){var i=$(n[r]).parent().parent().children("input")[0],a=0;"undefined"!=typeof i&&(a=i.value),o.push(a)}return o},l=function(t,n,e){var r=[],o=[];o.push(r);for(var i=void 0,a=void 0,u=0;u<t.length;u++)i=[],i.push(t[u]),i.push(0===n[u]?0:n[u]+3),i.push(0===e[u]?0:e[u]+6),a=new Set(i),a.size>1&&a.has(0)&&a["delete"](0),r.push(Array.from(a));return o},f=function(t){for(var n=[],e=0;e<t.length;e++)n.push(parseInt(t[e]));for(var r=1,a=[],u=void 0,c=void 0,l=0,e=0;e<n.length&&(u=e,c=n[u],!(c>0));e++);for(var f=0;o>f;f+=1){var d=[];a.push(d);for(var e=0;i>e;e+=1){if(r===c){for(l=u+1;n[(u+1)%n.length]<1;)u=(u+1)%n.length;c+=n[(u+1)%n.length],u=(u+1)%n.length}else l=0;d.push(l),r+=1}}return a},d=function(t,n,e,r){$(t).attr("fill",r),setTimeout(function(){$(t).attr("fill",n)},1e3*e)},s=function(n,e,r){for(var o=[],i="",u=1;4>u;u++)i="#btn-row"+n+"-"+u,o.push(i);for(var u in o)$(o[u]).parent().parent().children("input.form-control").change(function(){var o=f(c(n));a(o,e,r,!1);var i=f(c(1)),u=f(c(2)),d=f(c(3)),s=l(i[0],u[0],d[0]);a(s,d3.select("#chart-sum"),[0,1,2,3,4,5,6,7,8,9].map(function(n){return t[n].color}),!0)})},v=function(t){for(var n=[],e="",r=1;4>r;r++)e="#btn-row"+t+"-"+r,n.push(e);var o=jQuery.Event("change"),i=function(t){$(n[t]).parent().children("ul.dropdown-menu").on("click",function(e){$(n[t]).parent().parent().children("input.form-control:first").attr("value",e.target.text).trigger(o)})};for(var r in n)i(r)},h=function(n){for(var e=[],r="",o=1;4>o;o++)r="#btn-row"+n+"-"+o+"-ton",e.push(r);for(var o in e)$(e[o]).parent().children("ul.dropdown-menu").on("click",function(n){var e=parseInt(n.target.parentElement.parentElement.getAttribute("nr"));t[e].instrument=n.target.text,A(t,e)})},p=function(){$("#btn-row0-0-ton").parent().children("ul.dropdown-menu").on("click",function(n){t[0].instrument=n.target.text,A(t,0)})},g=function(n){for(var e=[],r="",o=1;4>o;o++)r="#btn-row"+n+"-"+o+"-volume",e.push(r);for(var o in e)$(e[o]).parent().children("ul.dropdown-menu").on("click",function(n){var e=parseInt(n.target.parentElement.parentElement.getAttribute("nr"));t[e].vol=n.target.text,t[e].gain=1*parseInt(n.target.text)/100,A(t,e)})},w=function(){$("#btn-row0-0-volume").parent().children("ul.dropdown-menu").on("click",function(n){t[0].vol=n.target.text,t[0].gain=1*parseInt(n.target.text)/100,A(t,0)})},m=function(t,n){if(t.children().length<2){var e=document.createElement("span");e.appendChild(document.createTextNode(n)),t.append(e)}else t.children().last().text(n)},A=function(t,n){var e=void 0,r=void 0;1>n?(e=0,r=n):(e=Math.trunc((n-1)/3)+1,r=(n-1)%3+1);var o=$("#btn-row"+e+"-"+r+"-ton"),i=" "+t[n].instrument;m(o,i),o=$("#btn-row"+e+"-"+r+"-volume"),i=" "+t[n].vol,m(o,i)},x=function(t){for(var n=0;n<t.length;n++)A(t,n)},b=function(){$("#playmusicbtn").on("click",function(t){E=!0,C()})},y=function(){$("#stopmusicbtn").on("click",function(t){E=!1})},q=function(e,r,o,i){var a=e+o,u=t[r].gain,c=T.createGain();c.gain.value=u,c.connect(T.destination);var l=T.createGain();l.connect(c),l.gain.value=0,l.gain.setTargetAtTime(1,e,I[0]),l.gain.setTargetAtTime(0,a,I[1]);var f=T.createOscillator();f.connect(l),f.type=N,f.detune.value=n[t[r].instrument].detune,f.frequency.value=240;var d=T.createGain();d.gain.value=G,d.connect(f.detune);var s=T.createOscillator();s.connect(d),s.frequency.value=M,f.start(e),s.start(e),f.stop(a+2),s.stop(a+2)},B=function X(){if(!E||0===k.length)return void console.log("stop");for(var n=T.currentTime;k.length>0&&k[0][0]<n+.15;){var e=k.splice(0,1);q(e[0][0],e[0][1],e[0][2],t[e[0][1]].gain),d(e[0][3],t[e[0][1]].color,e[0][2],t[e[0][1]].hover)}setTimeout(X,90)},E=!0,k=[],T=null;try{window.AudioContext=window.AudioContext||window.webkitAudioContext;var T=new AudioContext}catch(F){console.log("No Web Audio API support")}$("body").on("touchend",function(t){var n=T.createBuffer(1,1,22050),e=T.createBufferSource();e.buffer=n,e.connect(T.destination),"undefined"!=typeof e.noteOn&&e.noteOn(0);var r=null;r=T.createOscillator(),r.type="square",r.frequency.value=440,r.connect(T.destination);var o=T.currentTime;r.start(o+.02),r.stop(o+.05),$("body").on("touchend",function(t){})});var C=function(){var t=void 0,n=d3.select("#chart-sum").select("g").selectAll("g").data(),e=d3.select("#chart-sum").select("g").selectAll("g")[0],r=T.currentTime;k=[];for(var o=0;o<n.length;o++){var i=n[o];for(t=0;t<i.length;t++){var a=[];a.push(o*O+r+1e-4*t),a.push(i[t]),a.push(D),a.push(d3.select(e[o]).selectAll("rect")[0][t]),k.push(a)}}B()},O=.5,D=.3,G=.3,I=[.01,.1],M=6,N="sawtooth",z=function(t){t.map(function(t){if(t.visible)$("#"+t.id).show();else{var n=$("#"+t.id);n.hide(),"undefined"!=typeof n.children("input")[0]&&(n.children("input")[0].value=0)}})},S=function(t){var n=1280,e=45,r="0 0 "+(n+70)+" "+e,o=d3.select(t),i=o.append("svg").attr("width",n).attr("height",e).attr("viewBox",r).attr("preserveAspectRatio","xMidYMid meet");return i};z(t),x(t);var U=S("#chart"),_=[0,1,2,3].map(function(n){return t[n].color}),j=f(c(1));u(j,U,_,!1);var L=S("#chart-2"),P=[0,4,5,6].map(function(n){return t[n].color}),Q=f(c(2));u(Q,L,P,!1);var R=S("#chart-3"),W=[0,7,8,9].map(function(n){return t[n].color}),Y=f(c(3));u(Y,R,W,!1);var H=S("#chart-sum"),J=[0,1,2,3,4,5,6,7,8,9].map(function(n){return t[n].color}),K=l(j[0],Q[0],Y[0]);u(K,H,J,!0),d3.select(window).on("resize",function(){var t=$(window).width();U.attr("width",t),L.attr("width",t),R.attr("width",t),H.attr("width",t)});var V=$(window).width();U.attr("width",V),L.attr("width",V),R.attr("width",V),H.attr("width",V),w(),p(),[1,2,3].map(v),[1,2,3].map(h),[1,2,3].map(g),s(1,U,_),s(2,L,P),s(3,R,W),b(),y()})},{}]},{},[1]);